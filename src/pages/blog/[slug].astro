---
import Layout from '../../layouts/Layout.astro';
import { supabase } from '../../lib/supabaseServerClient'; // â† Î”Î™ÎŸÎ¡Î˜Î©Î˜Î—ÎšÎ•

export const prerender = false;

const { slug } = Astro.params;

const { data: article, error } = await supabase
  .from('articles')
  .select('*')
  .eq('slug', slug)
  .eq('published', true)
  .single();

const pageTitle = article?.title ?? 'Î†Î³Î½Ï‰ÏƒÏ„Î¿ Î¬ÏÎ¸ÏÎ¿';
const pageDescription = article?.excerpt ?? 'ÎœÎ¬Î»Î»Î¿Î½ Ï„Î¿ Î¬ÏÎ¸ÏÎ¿ Î¼ÎµÏ„Î±ÎºÏŒÎ¼Î¹ÏƒÎµ...';
const pageUrl = `https://hitlift.gr/blog/${slug}`;
---

<Layout title={pageTitle}>
  <head slot="head">
    <meta name="description" content={pageDescription} />
    <meta property="og:title" content={pageTitle} />
    <meta property="og:description" content={pageDescription} />
    <meta property="og:type" content="article" />
    <meta property="og:url" content={pageUrl} />
  </head>

  {article ? (
    <article class="prose prose-zinc dark:prose-invert max-w-3xl mx-auto py-12 px-4">
      <h1 class="mb-4">{article.title}</h1>
      <p class="text-sm text-zinc-500 mb-4">
        {new Date(article.created_at).toLocaleDateString('el-GR')}
      </p>

      {article.cover_image && (
        <img src={article.cover_image} alt="Î•Î¹ÎºÏŒÎ½Î± Î¬ÏÎ¸ÏÎ¿Ï…" class="mb-6 rounded-lg shadow" />
      )}

      <div innerHTML={article.content} />

      <div class="mt-12 text-center mb-24">
        <a href="/blog" class="inline-block text-[#50c7c2] hover:underline">
          â† Î•Ï€Î¹ÏƒÏ„ÏÎ¿Ï†Î® ÏƒÏ„Î¿ blog
        </a>
      </div>
    </article>
  ) : (
    <section class="text-center py-24">
      <h1 class="text-4xl font-bold mb-4">Î¤Î¿ Î¬ÏÎ¸ÏÎ¿ Ï‡Î¬Î¸Î·ÎºÎµ ÏƒÏ„Î± Ï„ÎµÏ„ÏÎ±Î³Ï‰Î½Î¹ÎºÎ¬ ğŸšï¸</h1>
      <p class="text-gray-600 dark:text-gray-400 mb-8">
        Î‰ Î´ÎµÎ½ Ï…Ï€Î®ÏÎ¾Îµ Ï€Î¿Ï„Î­, Î® ÎºÎ¬Ï€Î¿Î¹Î¿Ï‚ Ï„Î¿ Î­Î²Î±Î»Îµ ÎºÎ¬Ï„Ï‰ Î±Ï€ÏŒ Ï„Î¿ Ï‡Î±Î»Î¯.
      </p>
      <a
        href="/"
        class="inline-block bg-[#50c7c2] text-white px-6 py-3 rounded-lg shadow hover:bg-[#3db2b0] transition"
      >
        ğŸ  Î•Ï€Î¹ÏƒÏ„ÏÎ¿Ï†Î® ÏƒÏ„Î·Î½ Î±ÏÏ‡Î¹ÎºÎ®
      </a>
    </section>
  )}
</Layout>
