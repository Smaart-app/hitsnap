---
const user = Astro.props?.user || null;
const lang = Astro.props?.lang || 'el';
const altArticle = Astro.props?.altArticle || null;
const disableLangSwitch = Astro.props?.disableHeaderLangSwitch || false;

const isGreek = lang === 'el';
const base = isGreek ? '/el' : '/en';

const currentPath = Astro.url.pathname;
const isHome = currentPath === '/';
const isArticles = currentPath.includes('/blog') && !currentPath.includes('/editor');
const isContact = currentPath.includes('/contact');
const isDashboard = currentPath.includes('/dashboard');
const isEditor = currentPath.includes('/editor');

let langSwitchHref = isGreek ? '/en' : '/el';

if (isArticles && altArticle?.slug && altArticle?.lang) {
  langSwitchHref = `/${altArticle.lang}/blog/${altArticle.slug}`;
} else {
  const pathWithoutLang = currentPath.replace(/^\/(el|en)/, '');
  langSwitchHref = `/${isGreek ? 'en' : 'el'}${pathWithoutLang}`;
}
---

<header class="w-full border-b border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-950 shadow-sm">
  <div class="max-w-screen-xl mx-auto px-4 sm:px-6 py-3 sm:py-4 flex flex-wrap items-center justify-between gap-4">
    <!-- Î›Î¿Î³ÏŒÏ„Ï…Ï€Î¿ -->
    <a href="/" class="text-3xl tracking-tight flex items-center leading-none" style="font-family: 'Lora', serif;">
      <span class="font-bold text-black dark:text-white">Hit</span>
      <span class="font-normal text-[#50c7c2] ml-1">lift</span>
    </a>

    <!-- ÎšÎµÎ½Ï„ÏÎ¹ÎºÎ® Î Î»Î¿Î®Î³Î·ÏƒÎ· -->
    <nav class="flex flex-wrap items-center gap-4 sm:gap-6 text-sm sm:text-base font-medium text-zinc-700 dark:text-zinc-300">
      <a href="/" class={`${isHome ? 'text-[#50c7c2] font-bold' : 'hover:text-[#50c7c2]'} transition`}>
        {isGreek ? 'Î‘ÏÏ‡Î¹ÎºÎ®' : 'Home'}
      </a>
      <a href={`${base}/blog`} class={`${isArticles ? 'text-[#50c7c2] font-bold' : 'hover:text-[#50c7c2]'} transition`}>
        {isGreek ? 'Î†ÏÎ¸ÏÎ±' : 'Articles'}
      </a>
      <a href={`${base}/contact`} class={`${isContact ? 'text-[#50c7c2] font-bold' : 'hover:text-[#50c7c2]'} transition`}>
        {isGreek ? 'Î•Ï€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±' : 'Contact'}
      </a>
    </nav>

    <!-- Î”ÎµÎ¾Î¹Î¬ Î¶ÏÎ½Î·: Î“Î»ÏÏƒÏƒÎ± + Î¸Î­Î¼Î± + ÏƒÏÎ½Î´ÎµÏƒÎ· -->
    <div class="flex items-center gap-3 text-sm sm:text-base">
      {!disableLangSwitch && (
        <a
          href={langSwitchHref}
          class="hover:text-[#50c7c2] transition"
          target="_self"
          data-force-reload
        >
          {isGreek ? 'English ğŸ‡¬ğŸ‡§' : 'Î•Î»Î»Î·Î½Î¹ÎºÎ¬ ğŸ‡¬ğŸ‡·'}
        </a>
      )}

      <!-- Toggle theme Î¼Îµ ÎºÎ¿Î¼ÏˆÏŒ ÎµÎ¹ÎºÎ¿Î½Î¯Î´Î¹Î¿ -->
      <button
        id="toggle-theme"
        class="text-zinc-600 dark:text-zinc-300 hover:text-[#50c7c2] transition text-base"
        title={isGreek ? 'Î•Î½Î±Î»Î»Î±Î³Î® Î¸Î­Î¼Î±Ï„Î¿Ï‚' : 'Toggle theme'}
      >
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M12 3v1m0 16v1m8.66-11.66l-.707.707M4.05 19.95l-.707-.707M21 12h-1M4 12H3m16.95 7.95l-.707-.707M4.05 4.05l-.707.707M12 5a7 7 0 100 14 7 7 0 000-14z"/>
        </svg>
      </button>

      <!-- Î•Î½Î­ÏÎ³ÎµÎ¹ÎµÏ‚ Ï‡ÏÎ®ÏƒÏ„Î· -->
      {user ? (
        <>
          <a href="/dashboard" class={`${isDashboard ? 'text-[#50c7c2] font-bold' : 'hover:text-[#50c7c2]'} transition`}>
            ğŸ“‹ {isGreek ? 'Î Î¯Î½Î±ÎºÎ±Ï‚' : 'Dashboard'}
          </a>
          <a href={`${base}/blog/editor`} class={`${isEditor ? 'text-[#50c7c2] font-bold' : 'hover:text-[#50c7c2]'} transition`}>
            ğŸ“ {isGreek ? 'Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î±' : 'Editor'}
          </a>
          <a href="/api/logout" class="text-red-600 hover:underline">
            ğŸšª {isGreek ? 'Î‘Ï€Î¿ÏƒÏÎ½Î´ÎµÏƒÎ·' : 'Logout'}
          </a>
        </>
      ) : (
        <a href="/login" class="text-[#50c7c2] hover:underline">
          ğŸ” {isGreek ? 'Î•Î¯ÏƒÎ¿Î´Î¿Ï‚' : 'Login'}
        </a>
      )}
    </div>
  </div>
</header>
